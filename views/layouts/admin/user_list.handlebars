<head>
    <!-- Site Name -->
    <title>SCAUNIFEI - Gerenciar usuários</title>
</head>

<!-- Subintro
================================================== -->
<section id="subintro">
    <div class="container">
        <div class="row">
            <div class="span8">
                <ul class="breadcrumb">
                    <li><a href="/"><i class="icon-home icon-rounded active"></i></a><i class="icon-angle-right"></i>
                    </li>
                    <li><a href="/admin">Portal do Administrador</a> <i class="icon-angle-right"></i></li>
                    <li><a href="/admin/userslist">Gerenciar usuários</a></li>
                </ul>
            </div>
        </div>
    </div>
</section>

<!-- Conteúdo
================================================== -->
<section id="maincontent">
    <div class="container">
        <div class="row">

            {{#each errors}}
            <div class="alert alert-danger">{{text}}</div>
            {{else}}
            {{/each}}

            <div class="row">

                <div class="span6">
                    <h2>Lista de usuários cadastrados</h2>
                </div>

                <div class="span3 offset3">
                    <button class="btn btn-large btn-success" type="button" data-toggle="modal"
                        data-target="#adduser"><i class="icon-plus"></i>Adicionar usuário
                    </button>

                    <div class="modal fade" id="adduser" tabindex="-1" role="dialog" aria-labelledby="adduser"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="adduser">Adicionar usuário
                                    </h5>
                                </div>

                                <div class="modal-body">
                                    <form action="/admin/adduser" method="POST">
                                        <div class="row">

                                            <div class="span6 form-group">
                                                <div class="text-left">
                                                    <label for="name">Nome:</label>
                                                </div>
                                                <input type="text" class="input-block-level" name="name"
                                                    placeholder="Insira o nome do usuário"
                                                    pattern="[A-Za-zÀ-ÖØ-öø-ÿ ]{3,30}"
                                                    title="O nome deve conter somente letras e ter no mínimo 3 caracteres."
                                                    required>
                                            </div>

                                            <div class="span6 form-group">
                                                <div class="text-left">
                                                    <label for="surname">Sobrenome:</label>
                                                </div>
                                                <input type="text" class="input-block-level" name="surname"
                                                    placeholder="Insira o sobrenome do usuário"
                                                    pattern="[A-Za-zÀ-ÖØ-öø-ÿ ]{3,50}"
                                                    title="O sobrenome deve conter somente letras e ter no mínimo 3 caracteres."
                                                    required>
                                            </div>

                                            <div class="span6 form-group">
                                                <div class="text-left">
                                                    <label for="email" class="control-label">Email:</label>
                                                </div>
                                                <input type="email" class="input-block-level" name="email"
                                                    placeholder="Insira o email do usuário" required>
                                            </div>

                                            <div class="span6 form-group">
                                                <div class="text-left">
                                                    <label for="ra" class="control-label">Registro Acadêmico:</label>
                                                </div>
                                                <input type="text" class="input-block-level" name="ra"
                                                    placeholder="Insira o RA do usuário"
                                                    title="O RA é composto somente por números (5 dígitos na versão antiga e 10 na atual)"
                                                    minlength="5" maxlength="10" pattern="[0-9]+" required>
                                            </div>

                                            <div class="span6 form-group">
                                                <div class="text-left">
                                                    <label for="institute">Unidade Acadêmica:</label>
                                                </div>
                                                <select name="institute" class="input-block-level" required>
                                                    <option value="">- Selecione -</option>
                                                    <option value="ICT - Instituto de Ciências Tecnológicas">Instituto
                                                        de Ciências Tecnológicas (ICT)
                                                    </option>
                                                    <option value="IEI - Instituto de Engenharias Integradas">Instituto
                                                        de Engenharias Integradas (IEI)
                                                    </option>
                                                    <option value="ICPA - Instituto de Ciências Puras e Aplicadas">
                                                        Instituto de Ciências Puras e Aplicadas (ICPA)</option>
                                                </select>
                                            </div>

                                            <div class="span6 form-group">
                                                <div class="text-left">
                                                    <label for="course">Curso:</label>
                                                </div>
                                                <select name="course" class="input-block-level" required>
                                                    <option value="">- Selecione -</option>
                                                    <option value="EAM - Engenharia Ambiental">
                                                        Engenharia Ambiental (EAM)
                                                    </option>
                                                    <option value="EMB - Engenharia de Mobilidade">
                                                        Engenharia de Mobilidade (EMB)
                                                    </option>
                                                    <option value="ECO - Engenharia de Computação">
                                                        Engenharia de Computação (ECO)
                                                    </option>
                                                    <option value="ECA - Engenharia de Controle e Automação">
                                                        Engenharia de Controle e Automação (ECA)
                                                    </option>
                                                    <option value="EMT - Engenharia de Materiais">
                                                        Engenharia de Materiais (EMT)
                                                    </option>
                                                    <option value="EPR - Engenharia de Produção">
                                                        Engenharia de Produção (EPR)
                                                    </option>
                                                    <option value="ESS - Engenharia de Saúde e Segurança">
                                                        Engenharia de Saúde e Segurança (ESS)
                                                    </option>
                                                    <option value="EEL - Engenharia Elétrica">
                                                        Engenharia Elétrica (EEL)
                                                    </option>
                                                    <option value="EME - Engenharia Mecânica">
                                                        Engenharia Mecânica (EME)
                                                    </option>
                                                </select>
                                            </div>

                                            <div class="span6 form-group">
                                                <div class="text-left">
                                                    <label for="birthday">Data de Nascimento:</label>
                                                </div>
                                                <input type="date" class="input-block-level" name="birthday" required>
                                            </div>

                                            <div class="span6 form-group">
                                                <div class="text-left">
                                                    <label for="gender">Gênero:</label>
                                                </div>
                                                <select name="gender" class="input-block-level">
                                                    <option value="">- Selecione -</option>
                                                    <option value="Masculino">Masculino</option>
                                                    <option value="Feminino">Feminino</option>
                                                    <option value="Outro">Prefiro não dizer</option>
                                                </select>
                                            </div>

                                            <div class="span6 form-group">
                                                <div class="text-left">
                                                    <label for="docente">Docente:</label>
                                                </div>
                                                <select name="docente" class="input-block-level">
                                                    <option value="">- Selecione -</option>
                                                    <option value="true">Sim</option>
                                                    <option value="false">Não</option>
                                                </select>
                                            </div>

                                        </div>

                                        <div class="span6 center">
                                            <button type="button" class="btn btn-danger" data-dismiss="modal"><i
                                                    class="icon-remove icon-white"></i>
                                                Cancelar
                                            </button>
                                            <button class="btn btn-success" type="submit"><i
                                                    class="icon-ok icon-white"></i>
                                                Concluir
                                            </button>
                                        </div>
                                        <br>
                                    </form>

                                </div>
                                <div class="modal-footer">
                                    <br>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>

            <div class="row">

                <div class="span12 table-responsive">

                    <table class="table table-striped table-bordered table-hover">
                        <tbody>
                            <tr>
                                <th> Nº</th>
                                <th><i class="icon-user"></i> Nome</th>
                                <th><i class="icon-calendar"></i> Data de Nascimento</th>
                                <th><i class="icon-group"></i> Gênero</th>
                                <th><i class="icon-envelope-alt"></i> E-mail</th>
                                <th><i class="icon-pushpin"></i> RA</th>
                                <th><i class="icon-book"></i> Curso</th>
                                <th><i class="icon-tags"></i> Unidade Acadêmica</th>
                                <th><i class="icon-magic"></i> Docente</th>
                                <th><i class="icon-cogs"></i> Ações</th>
                            </tr>

                            {{#each users}}
                            <tr>
                                <td>{{@index}}</td>
                                <td>{{name}} {{surname}}</td>
                                <td>
                                    <script>
                                        var date = '{{birthday}}';
                                        function FormataStringData(date) {
                                            var dia = date.split("-")[2];
                                            var mes = date.split("-")[1];
                                            var ano = date.split("-")[0];

                                            return ("0" + dia).slice(-2) + '/' + ("0" + mes).slice(-2) + '/' + ano;
                                        }
                                        document.write(FormataStringData(date))
                                    </script>
                                </td>
                                <td>{{gender}}</td>
                                <td>{{email}}</td>
                                <td>{{ra}}</td>
                                <td>{{course}}</td>
                                <td>{{institute}}</td>
                                <td name='user_status'>{{docente}}</td>
                                <td>

                                    <div class="modal fade" id="edit{{_id}}" tabindex="-1" role="dialog"
                                        aria-labelledby="editmodal" aria-hidden="true">
                                        <div class="modal-dialog modal-dialog-centered" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="editmodal">Editar usuário:
                                                        <b>{{name}}</b>
                                                    </h5>
                                                </div>
                                                <div class="modal-body">

                                                    <form action="/admin/editusr" method="POST">
                                                        <div class="row">

                                                            <div class="span6 form-group">
                                                                <div class="text-left">
                                                                    <label for="text">Nome:</label>
                                                                </div>
                                                                <input type="text" class="input-block-level" name="name"
                                                                    placeholder="Insira o nome do usuário"
                                                                    pattern="[A-Za-zÀ-ÖØ-öø-ÿ ]{3,30}"
                                                                    title="O nome deve conter somente letras e ter no mínimo 3 caracteres."
                                                                    value="{{name}}" required>
                                                            </div>

                                                            <div class="span6 form-group">
                                                                <div class="text-left">
                                                                    <label for="text">Sobrenome:</label>
                                                                </div>
                                                                <input type="text" class="input-block-level"
                                                                    name="surname"
                                                                    placeholder="Insira o sobrenome do usuário"
                                                                    pattern="[A-Za-zÀ-ÖØ-öø-ÿ ]{3,30}"
                                                                    title="O sobrenome deve conter somente letras e ter no mínimo 3 caracteres."
                                                                    value="{{surname}}" required>
                                                            </div>

                                                            <div class="span6 form-group">
                                                                <div class="text-left">
                                                                    <label for="email"
                                                                        class="control-label">Email:</label>
                                                                </div>
                                                                <input type="email" class="input-block-level"
                                                                    name="email" placeholder="Insira o email do usuário"
                                                                    value="{{email}}" required>
                                                            </div>

                                                            <div class="span6 form-group">
                                                                <div class="text-left">
                                                                    <label for="ra" class="control-label">Registro
                                                                        Acadêmico:</label>
                                                                </div>
                                                                <input type="text" class="input-block-level" name="ra"
                                                                    placeholder="Insira o RA do usuário"
                                                                    title="O RA é composto somente por números (5 dígitos na versão antiga e 10 na atual)"
                                                                    minlength="5" maxlength="10" pattern="[0-9]+"
                                                                    value="{{ra}}" required>
                                                            </div>

                                                            <div class="span6 form-group">
                                                                <div class="text-left">
                                                                    <label for="institute">Unidade Acadêmica:</label>
                                                                </div>
                                                                <select name="institute" class="input-block-level"
                                                                    required>
                                                                    <option value="{{institute}}">-
                                                                        {{institute}} -</option>
                                                                    <option
                                                                        value="ICT - Instituto de Ciências Tecnológicas">
                                                                        Instituto de Ciências Tecnológicas (ICT)
                                                                    </option>
                                                                    <option
                                                                        value="IEI - Instituto de Engenharias Integradas">
                                                                        Instituto de Engenharias Integradas (IEI)
                                                                    </option>
                                                                    <option
                                                                        value="ICPA - Instituto de Ciências Puras e Aplicadas">
                                                                        Instituto de Ciências Puras e Aplicadas (ICPA)
                                                                    </option>
                                                                </select>
                                                            </div>

                                                            <div class="span6 form-group">
                                                                <div class="text-left">
                                                                    <label for="course">Curso:</label>
                                                                </div>
                                                                <select name="course" class="input-block-level"
                                                                    required>
                                                                    <option value="{{course}}">- {{course}} -
                                                                    </option>
                                                                    <option value="EAM - Engenharia Ambiental">
                                                                        Engenharia Ambiental (EAM)
                                                                    </option>
                                                                    <option value="EMB - Engenharia de Mobilidade">
                                                                        Engenharia de Mobilidade (EMB)
                                                                    </option>
                                                                    <option value="ECO - Engenharia de Computação">
                                                                        Engenharia de Computação (ECO)
                                                                    </option>
                                                                    <option
                                                                        value="ECA - Engenharia de Controle e Automação">
                                                                        Engenharia de Controle e Automação (ECA)
                                                                    </option>
                                                                    <option value="EMT - Engenharia de Materiais">
                                                                        Engenharia de Materiais (EMT)
                                                                    </option>
                                                                    <option value="EPR - Engenharia de Produção">
                                                                        Engenharia de Produção (EPR)
                                                                    </option>
                                                                    <option
                                                                        value="ESS - Engenharia de Saúde e Segurança">
                                                                        Engenharia de Saúde e Segurança (ESS)
                                                                    </option>
                                                                    <option value="EEL - Engenharia Elétrica">
                                                                        Engenharia Elétrica (EEL)
                                                                    </option>
                                                                    <option value="EME - Engenharia Mecânica">
                                                                        Engenharia Mêcanica (EME)
                                                                    </option>
                                                                </select>
                                                            </div>

                                                            <div class="span6 form-group">
                                                                <div class="text-left">
                                                                    <label for="date">Data de Nascimento:</label>
                                                                </div>
                                                                <input type="date" class="input-block-level"
                                                                    id="birthday" name="birthday" value="{{birthday}}"
                                                                    required>
                                                            </div>

                                                            <div class="span6 form-group">
                                                                <div class="text-left">
                                                                    <label for="gender">Gênero:</label>
                                                                </div>
                                                                <select name="gender" class="input-block-level">
                                                                    <option value="{{gender}}">- {{gender}} -
                                                                    </option>
                                                                    <option value="Masculino">Masculino</option>
                                                                    <option value="Feminino">Feminino</option>
                                                                    <option value="Outro">Prefiro não dizer</option>
                                                                </select>
                                                            </div>

                                                            <div class="span6 form-group">
                                                                <div class="text-left">
                                                                    <label for="docente">Docente:</label>
                                                                </div>
                                                                <select name="docente" class="input-block-level">
                                                                    <option value="{{docente}}">- {{docente}} -</option>
                                                                    <option value="true">Sim</option>
                                                                    <option value="false">Não</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="span6 center">
                                                            <button type="button" class="btn btn-danger"
                                                                data-dismiss="modal"><i
                                                                    class="icon-remove icon-white"></i>
                                                                Cancelar
                                                            </button>
                                                            <input type="hidden" name="id" value="{{_id}}">
                                                            <button class="btn btn-success" type="submit"><i
                                                                    class="icon-ok icon-white"></i>
                                                                Concluir
                                                            </button>
                                                        </div>
                                                        <br>
                                                    </form>

                                                </div>
                                                <div class="modal-footer">
                                                    <br>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="modal fade" id="delete{{_id}}" tabindex="-1" role="dialog"
                                        aria-labelledby="deletemodal" aria-hidden="true">
                                        <div class="modal-dialog modal-dialog-centered" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="deletemodal">Excluir usuário</h5>
                                                </div>
                                                <div class="modal-body">
                                                    <p>Você tem certeza que deseja excluir o usuário <b>{{name}}
                                                            {{surname}}</b>? Essa ação não pode ser desfeita!</p>
                                                </div>
                                                <div class="modal-footer">
                                                    <div class="span6 center">
                                                        <form action="/admin/deleteusr" method="POST">
                                                            <button type="button" class="btn btn-inverse"
                                                                data-dismiss="modal"><i
                                                                    class="icon-remove icon-white"></i>
                                                                Não
                                                            </button>
                                                            <input type="hidden" name="id" value="{{_id}}">
                                                            <button class="btn btn-danger" type="submit"><i
                                                                    class="icon-ok icon-white"></i>
                                                                Sim
                                                            </button>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <button class="btn btn-theme" type="button" data-toggle="modal"
                                        data-target="#edit{{_id}}"><i class="icon-edit"></i>
                                    </button>
                                    <br> <br>
                                    <button class="btn btn-danger" type="button" data-toggle="modal"
                                        data-target="#delete{{_id}}"><i class="icon-trash"></i>
                                    </button>

                                </td>
                            </tr>
                            {{else}}
                            <h2>Nenhum usuário cadastrado!</h2>
                            {{/each}}

                        </tbody>
                    </table>
                    <script>
                        function change_text() {
                            var elements = document.getElementsByName('user_status');
                            [].forEach.call(elements, function (elem) {
                                elem.textContent = elem.textContent ? elem.textContent.replace(/true/gi, 'Sim') : elem.innerText;
                                elem.textContent = elem.textContent ? elem.textContent.replace(/false/gi, 'Não') : elem.innerText;
                            });
                        }
                        window.onload = change_text;
                    </script>

                </div>
            </div>

        </div>
    </div>
</section>